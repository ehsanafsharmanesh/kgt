<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø·Ø±Ø­ Ø§Ø³ØªØ§Ù†ÛŒ Ø¯Ø±Ø®Øª Ø³Ø¨Ø² Ú©Ø±Ù…Ø§Ù†</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        /* --- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾Ø§ÛŒÙ‡ --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --primary-color: #2e7d32;
            --primary-dark: #1b5e20;
            --primary-light: #4caf50;
            --secondary-color: #ffd54f;
            --accent-color: #ff6f00;
            --text-dark: #1f2937;
            --text-light: #6b7280;
            --background: #f0fdf4;
            --white: #ffffff;
            --shadow-soft: 0 10px 30px -5px rgba(0, 0, 0, 0.1);
        }

        @font-face {
            font-family: 'Vazir';
            src: url('https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/Vazir.woff2') format('woff2');
        }

        body {
            font-family: 'Vazir', sans-serif;
            background: var(--background);
            color: var(--text-dark);
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* --- Ù†ÙˆØ§Ø± Ù†Ø§ÙˆØ¨Ø±ÛŒ (Ú¯Ø±Ø§ÙÛŒÚ© ÙØ§ÛŒÙ„ Ø§Ø±Ø³Ø§Ù„ÛŒ) --- */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            position: fixed; top: 0; width: 100%; z-index: 1000;
            padding: 0.8rem 0; box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }
        .nav-container {
            max-width: 1200px; margin: 0 auto; padding: 0 1.5rem;
            display: flex; justify-content: space-between; align-items: center;
        }
        .nav-logo { font-weight: 800; font-size: 1.4rem; color: var(--primary-dark); display: flex; align-items: center; gap: 0.5rem; cursor: pointer; }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø§Ø®ØªØµØ§ØµÛŒ ØªØ¨â€ŒÙ‡Ø§ (Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø´Ø¯Ù‡) */
        .nav-menu {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            background: #f1f8e9; /* Ù¾Ø³ Ø²Ù…ÛŒÙ†Ù‡ Ø³Ø¨Ø² Ø®ÛŒÙ„ÛŒ Ø±ÙˆØ´Ù† */
            padding: 0.5rem 1rem;
            border-radius: 50px; /* Ú¯Ø±Ø¯ Ú©Ø±Ø¯Ù† Ú©Ø§Ø¯Ø± */
            border: 1px solid #dcedc8;
        }

        .nav-link { 
            color: var(--text-dark); text-decoration: none; font-weight: 600; 
            font-size: 0.95rem; padding: 0.5rem 1rem; border-radius: 25px; 
            transition: all 0.3s; position: relative; cursor: pointer;
        }
        .nav-link:hover { color: var(--primary-dark); background: rgba(76, 175, 80, 0.1); transform: translateY(-1px); }
        .nav-link.active-tab { background: var(--primary-color); color: white; box-shadow: 0 4px 10px rgba(46,125,50,0.3); }
        
        .nav-btn { 
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)); 
            color: white; padding: 0.6rem 1.8rem; border-radius: 25px; 
            border: none; cursor: pointer; font-family: inherit; font-weight: 700;
            box-shadow: 0 4px 15px rgba(27, 94, 32, 0.3); transition: all 0.3s;
        }
        .nav-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(27, 94, 32, 0.4); }

        /* --- Ø³Ø§Ø®ØªØ§Ø± Ú©Ù„ÛŒ ØµÙØ­Ø§Øª --- */
        .main-section { display: none; padding-top: 100px; min-height: 100vh; animation: fadeIn 0.6s ease; }
        .main-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; }

        /* --- Ù‡ÛŒØ±Ùˆ (Hero) --- */
        .hero {
            background: radial-gradient(circle at 10% 20%, rgb(27, 94, 32) 0%, rgb(46, 125, 50) 90%);
            color: white; padding: 4rem 0 8rem; position: relative;
            border-bottom-left-radius: 60px; border-bottom-right-radius: 60px;
            margin-top: -100px; padding-top: 180px;
        }
        .hero-content { display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 4rem; align-items: center; }
        .hero-title { font-size: 3rem; font-weight: 900; line-height: 1.3; margin-bottom: 1.5rem; }
        .title-accent { display: block; color: var(--secondary-color); text-shadow: 0 0 20px rgba(255, 213, 79, 0.3); }
        .hero-desc { font-size: 1.1rem; opacity: 0.9; line-height: 1.8; margin-bottom: 2rem; max-width: 600px; }
        
        .stat-cards-hero { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-top: 3rem; }
        .hero-stat-card { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); border-radius: 16px; padding: 1rem; text-align: center; transition: transform 0.3s; }
        .hero-stat-card:hover { transform: translateY(-5px); background: rgba(255,255,255,0.2); }
        .hero-stat-val { font-size: 1.5rem; font-weight: bold; display: block; margin-bottom: 0.2rem; }
        .hero-stat-lbl { font-size: 0.8rem; opacity: 0.8; }

        /* --- Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¯Ø±Ø®Øª Ù„Ø§ÛŒÙˆ (Live Tree) --- */
        .tree-container-hero { position: relative; width: 300px; height: 350px; margin: 0 auto; }
        .live-tree-trunk { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 40px; height: 0; background: linear-gradient(90deg, #5D4037, #8D6E63); border-radius: 10px; z-index: 2; animation: growTrunk 1s forwards ease-out; }
        .live-tree-layer { position: absolute; left: 50%; transform: translateX(-50%) scale(0); border-radius: 50% 50% 50% 0; transform-origin: center bottom; box-shadow: 0 10px 20px rgba(0,0,0,0.2); opacity: 0; }
        .layer-1 { width: 220px; height: 90px; bottom: 60px; background: #2E7D32; z-index: 5; animation: growLayer 0.8s forwards 0.8s; }
        .layer-2 { width: 180px; height: 80px; bottom: 110px; background: #388E3C; z-index: 6; animation: growLayer 0.8s forwards 1.6s; }
        .layer-3 { width: 140px; height: 70px; bottom: 160px; background: #43A047; z-index: 7; animation: growLayer 0.8s forwards 2.4s; }
        .layer-4 { width: 100px; height: 60px; bottom: 210px; background: #4CAF50; z-index: 8; animation: growLayer 0.8s forwards 3.2s; }
        .layer-5 { width: 60px; height: 50px; bottom: 250px; background: #66BB6A; z-index: 9; animation: growLayer 0.8s forwards 4.0s; }
        @keyframes growTrunk { to { height: 80px; } }
        @keyframes growLayer { 
            0% { transform: translateX(-50%) scale(0) rotate(-45deg); opacity: 0; }
            70% { transform: translateX(-50%) scale(1.1) rotate(0deg); opacity: 1; }
            100% { transform: translateX(-50%) scale(1) rotate(0deg); opacity: 1; }
        }

        /* --- Ø¨Ø®Ø´ Ø¬ÙˆØ§ÛŒØ² (Ú©Ø¯ Ú©Ø§Ù…Ù„ Ø§Ø² ÙØ§ÛŒÙ„ Ø§Ø±Ø³Ø§Ù„ÛŒ) --- */
        .awards-section {
            padding: 0; position: relative; margin-top: -60px; margin-bottom: 4rem; z-index: 10;
        }
        .section-header-awards {
            text-align: center; margin-bottom: 2rem; color: var(--text-dark); /* Ø§ØµÙ„Ø§Ø­ Ø±Ù†Ú¯ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø§ÛŒÛŒ */
        }
        .awards-slider {
            max-width: 1000px; margin: 0 auto; position: relative; border-radius: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); background: var(--white);
            overflow: hidden; height: 450px;
        }
        .slides-container {
            display: flex; height: 100%; transition: transform 0.6s cubic-bezier(0.645, 0.045, 0.355, 1);
        }
        .award-slide {
            min-width: 100%; height: 100%; position: relative; display: flex;
            align-items: flex-end; justify-content: center; overflow: hidden;
        }
        .slide-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover; background-position: center; transition: transform 6s ease;
        }
        .award-slide.active .slide-bg { transform: scale(1.1); }
        .slide-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(27, 94, 32, 0.6) 50%, rgba(0,0,0,0.2) 100%);
            z-index: 1;
        }
        .award-content {
            position: relative; z-index: 2; text-align: center; padding: 3rem; color: white;
            width: 100%; transform: translateY(20px); opacity: 0; transition: all 0.5s ease 0.3s;
        }
        .award-slide.active .award-content { transform: translateY(0); opacity: 1; }
        
        .award-icon-box {
            width: 80px; height: 80px; background: var(--secondary-color); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 2.5rem;
            margin: 0 auto 1.5rem; box-shadow: 0 0 20px rgba(255, 213, 79, 0.6);
            border: 4px solid rgba(255,255,255,0.3);
        }
        .award-title { font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem; color: var(--secondary-color); }
        .award-description { font-size: 1.1rem; margin-bottom: 1.5rem; color: #e0e0e0; }
        .award-prize-tag {
            display: inline-block; background: rgba(255,255,255,0.15); backdrop-filter: blur(5px);
            border: 1px solid var(--secondary-color); padding: 0.8rem 2rem; border-radius: 50px;
            font-weight: bold; font-size: 1.1rem; color: white;
        }
        .slider-arrow {
            position: absolute; top: 50%; transform: translateY(-50%); width: 50px; height: 50px;
            border-radius: 50%; background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(5px);
            border: none; color: white; font-size: 1.5rem; cursor: pointer; z-index: 10; transition: all 0.3s;
        }
        .slider-arrow:hover { background: var(--white); color: var(--primary-color); transform: translateY(-50%) scale(1.1); }
        .arrow-prev { right: 20px; }
        .arrow-next { left: 20px; }
        .slider-nav {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 0.8rem; z-index: 10;
        }
        .nav-dot {
            width: 12px; height: 12px; background: rgba(255, 255, 255, 0.4);
            border-radius: 50%; cursor: pointer; transition: all 0.3s;
        }
        .nav-dot.active { background: var(--secondary-color); width: 30px; border-radius: 10px; }


        /* --- ÙÙˆØªØ± --- */
        .footer { background: #1b1b1b; color: #fff; padding: 3rem 0; margin-top: 4rem; text-align: center; border-top: 5px solid var(--primary-color); }
        .footer-links { display: flex; justify-content: center; gap: 2rem; margin-bottom: 2rem; flex-wrap: wrap; }
        .footer-link { color: #ccc; text-decoration: none; font-size: 1rem; transition: color 0.3s; }
        .footer-link:hover { color: var(--secondary-color); }
        .footer-copy { border-top: 1px solid #333; padding-top: 1.5rem; font-size: 0.9rem; color: #888; }

        /* --- Ø§Ø³ØªØ§ÛŒÙ„ Ù…Ø´ØªØ±Ú© ØµÙØ­Ø§Øª Ø¯Ø§Ø®Ù„ÛŒ --- */
        .page-header {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
            color: white; padding: 3rem 0; border-radius: 20px; margin-bottom: 2rem;
            position: relative; overflow: hidden; box-shadow: var(--shadow-soft);
        }
        .page-header::after { content: ''; position: absolute; right: 0; bottom: 0; width: 300px; height: 300px; background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='rgba(255, 255, 255, 0.1)' d='M44.7,-76.4C58.9,-69.2,71.8,-59.1,81.6,-46.6C91.4,-34.1,98.1,-19.2,95.8,-5.3C93.5,8.6,82.2,21.5,70.9,32.2C59.6,42.9,48.3,51.4,36.4,58.5C24.5,65.6,12,71.3,-1.2,73.4C-14.4,75.5,-29.8,74,-43.3,67.6C-56.8,61.2,-68.4,49.9,-76.3,36.4C-84.2,22.9,-88.4,7.2,-86.3,-7.5C-84.2,-22.2,-75.8,-35.9,-65.1,-46.8C-54.4,-57.7,-41.4,-65.8,-28.3,-73.6C-15.2,-81.4,-2,-88.9,12.2,-89.8C26.4,-90.7,40.8,-85,44.7,-76.4Z' transform='translate(100 100)' /%3E%3C/svg%3E") no-repeat bottom right; background-size: contain; }
        
        /* Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø¯Ø±Ù† Ùˆ Ø¬Ø¯Ø§ÙˆÙ„ */
        .stats-cards-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .modern-card { background: white; border-radius: 16px; padding: 1.5rem; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 1px solid #f0f0f0; display: flex; flex-direction: column; align-items: center; }
        .modern-card h3 { font-size: 0.9rem; color: var(--text-light); margin-bottom: 0.5rem; }
        .modern-card .value { font-size: 1.8rem; font-weight: bold; color: var(--primary-dark); }
        .modern-card .icon { font-size: 2rem; margin-bottom: 0.5rem; background: #e8f5e9; padding: 10px; border-radius: 50%; }
        .modern-table-container { background: white; border-radius: 16px; padding: 1.5rem; box-shadow: 0 4px 15px rgba(0,0,0,0.05); overflow-x: auto; }
        .modern-table { width: 100%; border-collapse: collapse; min-width: 600px; }
        .modern-table th { text-align: right; padding: 1rem; color: var(--text-light); font-weight: 600; border-bottom: 2px solid #f0f0f0; }
        .modern-table td { padding: 1rem; border-bottom: 1px solid #f0f0f0; color: var(--text-dark); }
        .modern-table tr:hover { background: #f9fafb; }
        .rank-badge { background: var(--secondary-color); color: var(--primary-dark); width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.9rem; }
        
        .tabs { display: flex; justify-content: center; gap: 1rem; margin-bottom: 2rem; }
        .tab-btn { padding: 0.8rem 2rem; border-radius: 50px; border: none; background: white; color: var(--text-light); cursor: pointer; font-weight: 600; font-family: inherit; box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: all 0.3s; }
        .tab-btn.active { background: var(--primary-color); color: white; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(46,125,50,0.3); }
        .tab-content { display: none; animation: fadeIn 0.4s; }
        .tab-content.active { display: block; }

        /* --- Ù¾Ø±ÙˆÙØ§ÛŒÙ„â€ŒÙ‡Ø§ --- */
        .school-profile-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
        @media (max-width: 768px) { .school-profile-grid { grid-template-columns: 1fr; } }
        .progress-circle-container { position: relative; width: 200px; height: 200px; margin: 0 auto; }
        .progress-svg { transform: rotate(-90deg); width: 100%; height: 100%; }
        .progress-circle-bg { fill: none; stroke: #e0e0e0; stroke-width: 10; }
        .progress-circle-fg { fill: none; stroke: var(--primary-color); stroke-width: 10; stroke-dasharray: 565; stroke-dashoffset: 565; transition: stroke-dashoffset 1.5s ease-out; stroke-linecap: round; filter: drop-shadow(0 0 5px var(--primary-color)); }
        .progress-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        
        .forest-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 10px; background: #e8f5e9; padding: 2rem; border-radius: 20px; min-height: 200px; max-height: 400px; overflow-y: auto; }
        .forest-tree-item { font-size: 2.5rem; text-align: center; animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; opacity: 0; transform: scale(0); }
        @keyframes popIn { to { opacity: 1; transform: scale(1); } }

        /* --- ÙØ±Ù… Ø¯Ø³ØªØ±Ø³ÛŒ (Ø¨Ø±ÙˆØ² Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ OTP) --- */
        .access-card { background: white; max-width: 400px; margin: 2rem auto; padding: 2rem; border-radius: 20px; box-shadow: var(--shadow-soft); text-align: center; }
        .access-input { width: 100%; padding: 1rem; border: 2px solid #eee; border-radius: 10px; margin: 1rem 0; font-family: inherit; outline: none; transition: border 0.3s; text-align: center; direction: ltr; }
        .access-input:focus { border-color: var(--primary-color); }
        .upload-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 2rem; }
        .upload-box { border: 2px dashed #cbd5e1; padding: 1.5rem; border-radius: 12px; cursor: pointer; transition: all 0.3s; background: #f8fafc; }
        .upload-box:hover { border-color: var(--primary-color); background: #f0fdf4; }

    </style>
</head>
<body>

    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo" onclick="showSection('home')">
                <span style="font-size: 1.8rem;">ğŸŒ³</span>
                <span>Ø¯Ø±Ø®Øª Ø³Ø¨Ø² Ú©Ø±Ù…Ø§Ù†</span>
            </div>
            <div class="nav-menu">
                <a class="nav-link active-tab" onclick="showSection('home')">Ø®Ø§Ù†Ù‡</a>
                <a class="nav-link" onclick="scrollToAwards()">Ø¬ÙˆØ§ÛŒØ²</a>
                <a class="nav-link" onclick="showSection('stats')">Ø¢Ù…Ø§Ø± Ø§Ø³ØªØ§Ù†ÛŒ</a>
                <a class="nav-link" onclick="showSection('school')">Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù…Ø¯Ø±Ø³Ù‡</a>
                <a class="nav-link" onclick="showSection('office')">Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø§Ø¯Ø§Ø±Ù‡</a>
                <button class="nav-btn" onclick="showSection('access')">Ù…Ø¯ÛŒØ±ÛŒØª</button>
            </div>
        </div>
    </nav>

    <section id="home" class="main-section active">
        <div class="hero">
            <div class="container">
                <div class="hero-content">
                    <div>
                        <span style="background: rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 20px; font-size: 0.9rem;">
                            ğŸŒ± Ø·Ø±Ø­ Ø²ÛŒØ³Øª Ù…Ø­ÛŒØ·ÛŒ Û±Û´Û°Û³
                        </span>
                        <h1 class="hero-title">Ù‡Ø± Ù…Ø¯Ø±Ø³Ù‡ØŒ Ù†Ø¬Ø§Øª ÛŒÚ© Ø¯Ø±Ø®Øª<span class="title-accent">Ø¢ÛŒÙ†Ø¯Ù‡â€ŒØ§ÛŒ Ø³Ø¨Ø² Ø¨Ø±Ø§ÛŒ Ú©Ø±Ù…Ø§Ù†</span></h1>
                        <p class="hero-desc">Ø·Ø±Ø­ Ø¨Ø²Ø±Ú¯ Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ú©Ø§ØºØ° Ø¨Ø§Ø·Ù„Ù‡ Ø¯Ø± Ù…Ø¯Ø§Ø±Ø³ Ø§Ø³ØªØ§Ù† Ú©Ø±Ù…Ø§Ù†. Ø¨Ø§ Ù…Ø´Ø§Ø±Ú©Øª Ø¯Ø± Ø§ÛŒÙ† Ø·Ø±Ø­ØŒ Ø¹Ù„Ø§ÙˆÙ‡ Ø¨Ø± ØªØ¬Ù‡ÛŒØ² Ù…Ø¯Ø±Ø³Ù‡ Ø®ÙˆØ¯ØŒ Ø¨Ù‡ Ø­ÙØ¸ Ø¬Ù†Ú¯Ù„â€ŒÙ‡Ø§ÛŒ Ø¨Ù„ÙˆØ· Ú©Ù…Ú© Ú©Ù†ÛŒØ¯.</p>
                        
                        <div class="stat-cards-hero">
                            <div class="hero-stat-card">
                                <span class="hero-stat-val">Û±,Û²ÛµÛ°</span>
                                <span class="hero-stat-lbl">Ù…Ø¯Ø±Ø³Ù‡ ÙØ¹Ø§Ù„</span>
                            </div>
                            <div class="hero-stat-card">
                                <span class="hero-stat-val">Û³Û±Ûµ</span>
                                <span class="hero-stat-lbl">Ø¯Ø±Ø®Øª Ù†Ø¬Ø§Øªâ€ŒÛŒØ§ÙØªÙ‡</span>
                            </div>
                            <div class="hero-stat-card">
                                <span class="hero-stat-val" id="topOfficeNameHero">Ù†Ø§Ø­ÛŒÙ‡ Û²</span>
                                <span class="hero-stat-lbl">Ø§Ø¯Ø§Ø±Ù‡ Ø¨Ø±ØªØ±</span>
                            </div>
                            <div class="hero-stat-card">
                                <span class="hero-stat-val" id="topSchoolNameHero">Ø§Ù…Ø§Ù… Ø±Ø¶Ø§</span>
                                <span class="hero-stat-lbl">Ù…Ø¯Ø±Ø³Ù‡ Ø¨Ø±ØªØ±</span>
                            </div>
                        </div>

                        <div style="margin-top: 2rem;">
                            <button class="nav-btn" style="background: var(--secondary-color); color: var(--primary-dark); font-weight: bold; padding: 1rem 2rem;" onclick="showSection('school')">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù¾Ù†Ù„ Ù…Ø¯Ø±Ø³Ù‡</button>
                        </div>
                    </div>

                    <div class="tree-container-hero">
                        <div class="live-tree-trunk"></div>
                        <div class="live-tree-layer layer-1"></div>
                        <div class="live-tree-layer layer-2"></div>
                        <div class="live-tree-layer layer-3"></div>
                        <div class="live-tree-layer layer-4"></div>
                        <div class="live-tree-layer layer-5"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="awards-section" id="awards-anchor">
            <div class="container">
                <div class="section-header-awards">
                    <h2 style="font-size: 2rem; margin-bottom: 0.5rem; color: var(--primary-dark);">Ø¬Ø´Ù†ÙˆØ§Ø±Ù‡ Ø¬ÙˆØ§ÛŒØ² Ø¨Ø²Ø±Ú¯ Ø³Ø¨Ø²</h2>
                    <p style="opacity: 0.9; color: var(--primary-dark);">ØªÙ‚Ø¯ÛŒØ± Ø§Ø² ØªÙ„Ø§Ø´Ú¯Ø±Ø§Ù† Ø­ÙØ¸ Ù…Ø­ÛŒØ· Ø²ÛŒØ³Øª Ø¨Ø§ Ø¬ÙˆØ§ÛŒØ² Ù†ÙÛŒØ³</p>
                </div>
                
                <div class="awards-slider" id="awardsSlider">
                    <div class="slides-container" id="slidesContainer">
                        
                        <div class="award-slide">
                            <div class="slide-bg" style="background-image: url('https://images.unsplash.com/photo-1560785496-4c97b98d2c0b?q=80&w=1000&auto=format&fit=crop');"></div>
                            <div class="slide-overlay"></div>
                            <div class="award-content">
                                <div class="award-icon-box">ğŸ–¥ï¸</div>
                                <h3 class="award-title">ØªØ¬Ù‡ÛŒØ² Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù…Ø¯Ø§Ø±Ø³</h3>
                                <p class="award-description">ØªØ®ØªÙ‡ Ù‡ÙˆØ´Ù…Ù†Ø¯ØŒ ÙˆÛŒØ¯Ø¦Ùˆ Ù¾Ø±ÙˆÚ˜Ú©ØªÙˆØ± Ùˆ Ù„Ù¾â€ŒØªØ§Ù¾ Ø¨Ø±Ø§ÛŒ Ù…Ø¯Ø§Ø±Ø³ Ø¨Ø±ØªØ± Ø¯Ø± Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ú©Ø§ØºØ°</p>
                                <div class="award-prize-tag">ÙˆÛŒÚ˜Ù‡ Û³ Ù…Ø¯Ø±Ø³Ù‡ Ø§ÙˆÙ„ Ø§Ø³ØªØ§Ù†</div>
                            </div>
                        </div>

                        <div class="award-slide">
                            <div class="slide-bg" style="background-image: url('https://images.unsplash.com/photo-1517649763962-0c623066013b?q=80&w=1000&auto=format&fit=crop');"></div>
                            <div class="slide-overlay"></div>
                            <div class="award-content">
                                <div class="award-icon-box">ğŸš²</div>
                                <h3 class="award-title">ØªØ¬Ù‡ÛŒØ²Ø§Øª ÙˆØ±Ø²Ø´ÛŒ Ùˆ Ø³Ù„Ø§Ù…Øª</h3>
                                <p class="award-description">Ø§Ù‡Ø¯Ø§ÛŒ Ø¯ÙˆÚ†Ø±Ø®Ù‡ Ú©ÙˆÙ‡Ø³ØªØ§Ù† Ùˆ Ø³Øª Ú©Ø§Ù…Ù„ ÙˆØ±Ø²Ø´ÛŒ Ø¨Ù‡ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† ÙØ¹Ø§Ù„</p>
                                <div class="award-prize-tag">Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒ Ø¨ÛŒÙ† ÛµÛ° Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ø¨Ø±ØªØ±</div>
                            </div>
                        </div>

                        <div class="award-slide">
                            <div class="slide-bg" style="background-image: url('https://images.unsplash.com/photo-1501785888041-af3ef285b470?q=80&w=1000&auto=format&fit=crop');"></div>
                            <div class="slide-overlay"></div>
                            <div class="award-content">
                                <div class="award-icon-box">âœˆï¸</div>
                                <h3 class="award-title">Ø³ÙØ± ØªÙØ±ÛŒØ­ÛŒ Ø´Ù…Ø§Ù„</h3>
                                <p class="award-description">ØªÙˆØ± Û´ Ø±ÙˆØ²Ù‡ ØªÙØ±ÛŒØ­ÛŒ Ø¨Ù‡ Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§Ù„ÛŒ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø¯Ø± Ø§Ø¬Ø±Ø§ÛŒÛŒ Ù…Ø¯Ø§Ø±Ø³ Ù†Ù…ÙˆÙ†Ù‡</p>
                                <div class="award-prize-tag">ÙˆÛŒÚ˜Ù‡ Ù…Ø¯ÛŒØ±Ø§Ù† Ùˆ Ù…Ø¹Ø§ÙˆÙ†ÛŒÙ† Ø¨Ø±ØªØ±</div>
                            </div>
                        </div>

                        <div class="award-slide">
                            <div class="slide-bg" style="background-image: url('https://images.unsplash.com/photo-1627931398857-e685f4039365?q=80&w=1000&auto=format&fit=crop');"></div>
                            <div class="slide-overlay"></div>
                            <div class="award-content">
                                <div class="award-icon-box">ğŸ†</div>
                                <h3 class="award-title">ØªÙ†Ø¯ÛŒØ³ Ø²Ø±ÛŒÙ† Ù…Ø­ÛŒØ· Ø²ÛŒØ³Øª</h3>
                                <p class="award-description">Ù†Ø´Ø§Ù† Ø±Ø³Ù…ÛŒ Ùˆ ØªÙ‚Ø¯ÛŒØ±Ù†Ø§Ù…Ù‡ Ø¨Ø§ Ø§Ù…Ø¶Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø± Ù…Ø­ØªØ±Ù… + Ø§Ø¹ØªØ¨Ø§Ø± Ù†Ù‚Ø¯ÛŒ</p>
                                <div class="award-prize-tag">Ù…Ø¹ØªØ¨Ø±ØªØ±ÛŒÙ† Ù†Ø´Ø§Ù† Ø§Ø³ØªØ§Ù†ÛŒ</div>
                            </div>
                        </div>

                    </div>
                    
                    <button class="slider-arrow arrow-prev" onclick="changeSlide(-1)">â®</button>
                    <button class="slider-arrow arrow-next" onclick="changeSlide(1)">â¯</button>
                    
                    <div class="slider-nav" id="sliderNav">
                        <div class="nav-dot active" onclick="goToSlide(0)"></div>
                        <div class="nav-dot" onclick="goToSlide(1)"></div>
                        <div class="nav-dot" onclick="goToSlide(2)"></div>
                        <div class="nav-dot" onclick="goToSlide(3)"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="stats" class="main-section">
        <div class="container">
            <div class="page-header">
                <div style="padding: 0 2rem; position: relative; z-index: 2;">
                    <h1>Ø¢Ù…Ø§Ø± Ø¬Ø§Ù…Ø¹ Ø§Ø³ØªØ§Ù†ÛŒ</h1>
                    <p>Ú¯Ø²Ø§Ø±Ø´ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù…Ø¯Ø§Ø±Ø³ Ùˆ Ø§Ø¯Ø§Ø±Ø§Øª Ø§Ø³ØªØ§Ù† Ú©Ø±Ù…Ø§Ù†</p>
                </div>
            </div>

            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('schools-rank')">Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ø¯Ø§Ø±Ø³</button>
                <button class="tab-btn" onclick="switchTab('offices-rank')">Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø¯Ø§Ø±Ø§Øª</button>
            </div>

            <div id="schools-rank" class="tab-content active">
                <div class="modern-table-container">
                    <table class="modern-table">
                        <thead>
                            <tr>
                                <th>Ø±ØªØ¨Ù‡</th>
                                <th>Ù†Ø§Ù… Ù…Ø¯Ø±Ø³Ù‡</th>
                                <th>Ù…Ù†Ø·Ù‚Ù‡</th>
                                <th>Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ (kg)</th>
                                <th>ÙˆØ¶Ø¹ÛŒØª</th>
                            </tr>
                        </thead>
                        <tbody id="schoolsTableBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="offices-rank" class="tab-content">
                <div class="modern-table-container">
                    <table class="modern-table">
                        <thead>
                            <tr>
                                <th>Ø±ØªØ¨Ù‡</th>
                                <th>Ù†Ø§Ù… Ø§Ø¯Ø§Ø±Ù‡</th>
                                <th>ØªØ¹Ø¯Ø§Ø¯ Ù…Ø¯Ø§Ø±Ø³</th>
                                <th>Ú©Ù„ Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ (kg)</th>
                                <th>Ø¹Ù…Ù„Ú©Ø±Ø¯</th>
                            </tr>
                        </thead>
                        <tbody id="officesTableBody">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <section id="school" class="main-section">
        <div class="container">
            <div class="page-header">
                <div style="padding: 0 2rem; position: relative; z-index: 2;">
                    <span style="background: var(--secondary-color); color: var(--primary-dark); padding: 5px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: bold;">Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù…Ø¯Ø±Ø³Ù‡ Ø¨Ø±ØªØ±</span>
                    <h1 id="schoolProfileName" style="margin-top: 10px;">Ø¯Ø¨ÛŒØ±Ø³ØªØ§Ù† Ù†Ù…ÙˆÙ†Ù‡ Ø¯ÙˆÙ„ØªÛŒ Ø§Ù…Ø§Ù… Ø±Ø¶Ø§</h1>
                    <p id="schoolProfileRegion">Ù†Ø§Ø­ÛŒÙ‡ Û± Ú©Ø±Ù…Ø§Ù† | Ú©Ø¯: KER-01-02</p>
                </div>
            </div>

            <div class="school-profile-grid">
                <div class="modern-card">
                    <h3>ÙˆØ¶Ø¹ÛŒØª Ø¯Ø±Ø®Øª Ù…Ø¯Ø±Ø³Ù‡</h3>
                    <div class="tree-container-hero" style="transform: scale(0.8); height: 280px;">
                        <div class="live-tree-trunk"></div>
                        <div class="live-tree-layer layer-1" id="sl-1"></div>
                        <div class="live-tree-layer layer-2" id="sl-2"></div>
                        <div class="live-tree-layer layer-3" id="sl-3"></div>
                        <div class="live-tree-layer layer-4" id="sl-4"></div>
                        <div class="live-tree-layer layer-5" id="sl-5"></div>
                    </div>
                    <p style="color: var(--primary-color); font-weight: bold; margin-top: 1rem;">Ø´Ù…Ø§ Ø¯Ø± Ø­Ø§Ù„ Ù†Ø¬Ø§Øª ÛŒÚ© Ø¯Ø±Ø®Øª Ù‡Ø³ØªÛŒØ¯!</p>
                </div>

                <div class="modern-card">
                    <div class="progress-circle-container">
                        <svg class="progress-svg">
                            <circle class="progress-circle-bg" cx="100" cy="100" r="90"></circle>
                            <circle class="progress-circle-fg" id="schoolProgressCircle" cx="100" cy="100" r="90"></circle>
                        </svg>
                        <div class="progress-text">
                            <div style="font-size: 2.5rem; font-weight: bold; color: var(--primary-color);" id="schoolPercentText">0%</div>
                            <div style="color: #888; font-size: 0.9rem;">Ù¾ÛŒØ´Ø±ÙØª</div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; width: 100%; margin-top: 2rem;">
                        <div style="text-align: center; background: #f9f9f9; padding: 1rem; border-radius: 10px;">
                            <div style="font-size: 0.8rem; color: #888;">ÙˆØ²Ù† Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø´Ø¯Ù‡</div>
                            <div style="font-size: 1.2rem; font-weight: bold;" id="schoolWeightText">0 kg</div>
                        </div>
                        <div style="text-align: center; background: #f9f9f9; padding: 1rem; border-radius: 10px;">
                            <div style="font-size: 0.8rem; color: #888;">Ø±ØªØ¨Ù‡ Ø¯Ø± Ø§Ø³ØªØ§Ù†</div>
                            <div style="font-size: 1.2rem; font-weight: bold; color: var(--secondary-color);" id="schoolRankText">-</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem; width: 100%; padding: 1rem; background: #fff3cd; border-radius: 10px; font-size: 0.9rem; color: #856404;">
                        ğŸ’¡ <strong>Ù†Ú©ØªÙ‡:</strong> Ù‡Ø± Û²ÛµÛ° Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù… Ú©Ø§ØºØ° Ù…Ø¹Ø§Ø¯Ù„ Ù†Ø¬Ø§Øª ÛŒÚ© Ø¯Ø±Ø®Øª Ø§Ø³Øª.
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="office" class="main-section">
        <div class="container">
            <div class="page-header" style="background: linear-gradient(135deg, #1b5e20, #004d40);">
                <div style="padding: 0 2rem; position: relative; z-index: 2;">
                    <span style="background: white; color: #004d40; padding: 5px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: bold;">Ø§Ø¯Ø§Ø±Ù‡ Ù¾ÛŒØ´ØªØ§Ø²</span>
                    <h1 id="officeProfileName" style="margin-top: 10px;">Ø§Ø¯Ø§Ø±Ù‡ Ø¢Ù…ÙˆØ²Ø´ Ùˆ Ù¾Ø±ÙˆØ±Ø´ Ù†Ø§Ø­ÛŒÙ‡ Û²</h1>
                    <p id="officeProfileStats">Ù…Ø¯Ø§Ø±Ø³ ÙØ¹Ø§Ù„: 52 | Ú©Ù„ Ú©Ø§ØºØ°: 7200 kg</p>
                </div>
            </div>

            <div class="stats-cards-row">
                <div class="modern-card">
                    <div class="icon">ğŸŒ²</div>
                    <h3>Ø¬Ù†Ú¯Ù„ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡</h3>
                    <div class="value" id="officeTreeCount">0</div>
                </div>
                <div class="modern-card">
                    <div class="icon">âš–ï¸</div>
                    <h3>Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù‡Ø± Ù…Ø¯Ø±Ø³Ù‡</h3>
                    <div class="value" id="officeAvgWeight">0 kg</div>
                </div>
                <div class="modern-card">
                    <div class="icon">ğŸ¥‡</div>
                    <h3>Ø±ØªØ¨Ù‡ Ø§Ø³ØªØ§Ù†ÛŒ</h3>
                    <div class="value" id="officeRank">1</div>
                </div>
            </div>

            <h2 style="margin: 2rem 0 1rem; color: var(--primary-dark);">Ø¬Ù†Ú¯Ù„ Ù…Ø¬Ø§Ø²ÛŒ Ø§Ø¯Ø§Ø±Ù‡</h2>
            <div class="forest-grid" id="officeForestGrid">
                </div>
        </div>
    </section>

    <section id="access" class="main-section">
        <div class="container">
            <div class="access-card" id="loginCard">
                <h2 style="margin-bottom: 1rem;">ÙˆØ±ÙˆØ¯ Ø§Ù…Ù† Ù…Ø¯ÛŒØ±Ø§Ù†</h2>
                <p style="color: #666; margin-bottom: 2rem;">Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± ÛŒÚ©Ø¨Ø§Ø± Ù…ØµØ±ÙØŒ Ø§ÛŒÙ…ÛŒÙ„ Ù…Ø¬Ø§Ø² Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</p>
                
                <div id="emailStep">
                    <input type="email" class="access-input" id="emailInput" placeholder="example@email.com">
                    <button class="nav-btn" onclick="requestOTP()" style="width: 100%; padding: 1rem;">Ø§Ø±Ø³Ø§Ù„ Ú©Ø¯ ØªØ§ÛŒÛŒØ¯</button>
                </div>

                <div id="otpStep" style="display: none;">
                    <p style="color: var(--primary-color); font-weight: bold; margin-bottom: 10px;">Ú©Ø¯ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡ Ø¨Ù‡ Ø§ÛŒÙ…ÛŒÙ„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</p>
                    <input type="text" class="access-input" id="otpInput" placeholder="_ _ _ _ _" maxlength="5">
                    <button class="nav-btn" onclick="verifyOTP()" style="width: 100%; padding: 1rem;">ØªØ§ÛŒÛŒØ¯ Ùˆ ÙˆØ±ÙˆØ¯</button>
                    <button onclick="resetLogin()" style="margin-top: 1rem; background: none; border: none; color: #666; cursor: pointer; text-decoration: underline;">ØªØºÛŒÛŒØ± Ø§ÛŒÙ…ÛŒÙ„</button>
                </div>
            </div>

            <div id="adminPanel" style="display: none;">
                <h2 style="text-align: center; margin-bottom: 2rem;">Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</h2>
                <div class="upload-grid">
                    <div class="upload-box" onclick="document.getElementById('schoolsFile').click()">
                        <div style="font-size: 2.5rem; margin-bottom: 1rem;">ğŸ«</div>
                        <h3>Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¯Ø§Ø±Ø³</h3>
                        <p style="color: #888; font-size: 0.9rem;">ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø¯Ø§Ø±Ø³</p>
                        <input type="file" id="schoolsFile" hidden accept=".xlsx, .xls">
                    </div>
                    <div class="upload-box" onclick="document.getElementById('officesFile').click()">
                        <div style="font-size: 2.5rem; margin-bottom: 1rem;">ğŸ¢</div>
                        <h3>Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø¯Ø§Ø±Ø§Øª</h3>
                        <p style="color: #888; font-size: 0.9rem;">ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¯Ø§Ø±Ø§Øª</p>
                        <input type="file" id="officesFile" hidden accept=".xlsx, .xls">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-links">
                <a href="#" onclick="showSection('home')" class="footer-link">ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a>
                <a href="#" onclick="showSection('stats')" class="footer-link">Ø¢Ù…Ø§Ø± Ùˆ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§</a>
                <a href="#" onclick="showSection('access')" class="footer-link">Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</a>
                <a href="#" class="footer-link">ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ø§</a>
            </div>
            <div class="footer-copy">
                &copy; Û±Û´Û°Û³ Ø·Ø±Ø­ Ø§Ø³ØªØ§Ù†ÛŒ Ø¯Ø±Ø®Øª Ø³Ø¨Ø² Ú©Ø±Ù…Ø§Ù†. ØªÙ…Ø§Ù…ÛŒ Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª.
            </div>
        </div>
    </footer>

    <script>
        // --- Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ ---
        let data = {
            schools: [
                { 'Ù†Ø§Ù…_Ù…Ø¯Ø±Ø³Ù‡': 'Ø¯Ø¨ÛŒØ±Ø³ØªØ§Ù† Ø§Ù…Ø§Ù… Ø±Ø¶Ø§', 'Ù…Ù†Ø·Ù‚Ù‡': 'Ù†Ø§Ø­ÛŒÙ‡ Û±', 'Ù…ÛŒØ²Ø§Ù†_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…': 280, 'Ú©Ø¯': 'KER-01-02', 'isTop': true },
                { 'Ù†Ø§Ù…_Ù…Ø¯Ø±Ø³Ù‡': 'Ø¯Ø¨ÛŒØ±Ø³ØªØ§Ù† Ø´Ù‡Ø¯Ø§ÛŒ Ú©Ø±Ù…Ø§Ù†', 'Ù…Ù†Ø·Ù‚Ù‡': 'Ù†Ø§Ø­ÛŒÙ‡ Û±', 'Ù…ÛŒØ²Ø§Ù†_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…': 125, 'Ú©Ø¯': 'KER-01-01' },
                { 'Ù†Ø§Ù…_Ù…Ø¯Ø±Ø³Ù‡': 'Ù‡Ù†Ø±Ø³ØªØ§Ù† ÙÙ†ÛŒ Ù‚Ø¯Ø³', 'Ù…Ù†Ø·Ù‚Ù‡': 'Ù†Ø§Ø­ÛŒÙ‡ Û²', 'Ù…ÛŒØ²Ø§Ù†_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…': 200, 'Ú©Ø¯': 'KER-02-01' }
            ],
            offices: [
                { 'Ù†Ø§Ù…_Ø§Ø¯Ø§Ø±Ù‡': 'Ø§Ø¯Ø§Ø±Ù‡ Ù†Ø§Ø­ÛŒÙ‡ Û²', 'ØªØ¹Ø¯Ø§Ø¯_Ù…Ø¯Ø§Ø±Ø³': 52, 'Ø¬Ù…Ø¹_Ú©Ù„_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…': 7200, 'isTop': true },
                { 'Ù†Ø§Ù…_Ø§Ø¯Ø§Ø±Ù‡': 'Ø§Ø¯Ø§Ø±Ù‡ Ù†Ø§Ø­ÛŒÙ‡ Û±', 'ØªØ¹Ø¯Ø§Ø¯_Ù…Ø¯Ø§Ø±Ø³': 48, 'Ø¬Ù…Ø¹_Ú©Ù„_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…': 5600 }
            ]
        };

        // --- Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ø§ÙˆØ¨Ø±ÛŒ ---
        function showSection(id) {
            document.querySelectorAll('.main-section').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active-tab'));
            if(id === 'home') document.querySelector('.nav-menu .nav-link:nth-child(1)').classList.add('active-tab');

            window.scrollTo({top: 0, behavior: 'smooth'});

            if(id === 'school') updateSchoolProfile();
            if(id === 'office') updateOfficeProfile();
            if(id === 'stats') renderStatsTables();
        }

        function scrollToAwards() {
            showSection('home');
            setTimeout(() => {
                document.getElementById('awards-anchor').scrollIntoView({behavior: 'smooth'});
            }, 100);
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');
        }

        // --- Ø§Ø³Ù„Ø§ÛŒØ¯Ø± Ø¬ÙˆØ§ÛŒØ² (JS Ø§Ø² ÙØ§ÛŒÙ„ Ø§Ø±Ø³Ø§Ù„ÛŒ) ---
        let currentSlide = 0;
        const totalSlides = 4;
        let slideInterval;

        function initSlider() {
            if (slideInterval) clearInterval(slideInterval);
            slideInterval = setInterval(() => { changeSlide(1); }, 5000);
            updateSliderUI();
        }

        function changeSlide(direction) {
            currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
            updateSliderUI();
            resetInterval();
        }

        function goToSlide(index) {
            currentSlide = index;
            updateSliderUI();
            resetInterval();
        }

        function resetInterval() {
            clearInterval(slideInterval);
            slideInterval = setInterval(() => { changeSlide(1); }, 5000);
        }

        function updateSliderUI() {
            const container = document.getElementById('slidesContainer');
            const dots = document.querySelectorAll('.nav-dot');
            const slides = document.querySelectorAll('.award-slide');
            
            if(container) {
                container.style.transform = `translateX(${currentSlide * 100}%)`;
            }
            
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlide);
            });

            slides.forEach((slide, index) => {
                if (index === currentSlide) {
                    slide.classList.add('active');
                } else {
                    slide.classList.remove('active');
                }
            });
        }

        // --- Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ú©Ø³Ù„ ---
        document.addEventListener('DOMContentLoaded', () => {
            setupExcelListeners();
            refreshAllData(); 
            initSlider();
        });

        function setupExcelListeners() {
            document.getElementById('schoolsFile').addEventListener('change', (e) => processFile(e.target.files[0], 'schools'));
            document.getElementById('officesFile').addEventListener('change', (e) => processFile(e.target.files[0], 'offices'));
        }

        function processFile(file, type) {
            if(!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                const workbook = XLSX.read(e.target.result, {type: 'array'});
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const json = XLSX.utils.sheet_to_json(sheet);
                
                if(json.length > 0) {
                    data[type] = json;
                    if(type === 'schools') {
                        data.schools.forEach(s => s.isTop = false);
                        data.schools.sort((a,b) => b['Ù…ÛŒØ²Ø§Ù†_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…'] - a['Ù…ÛŒØ²Ø§Ù†_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…']);
                        if(data.schools.length > 0) data.schools[0].isTop = true;
                    }
                    if(type === 'offices') {
                        data.offices.forEach(o => o.isTop = false);
                        data.offices.sort((a,b) => b['Ø¬Ù…Ø¹_Ú©Ù„_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…'] - a['Ø¬Ù…Ø¹_Ú©Ù„_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…']);
                        if(data.offices.length > 0) data.offices[0].isTop = true;
                    }
                    
                    refreshAllData();
                    alert(`Ø§Ø·Ù„Ø§Ø¹Ø§Øª ${type === 'schools' ? 'Ù…Ø¯Ø§Ø±Ø³' : 'Ø§Ø¯Ø§Ø±Ø§Øª'} Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯.`);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function refreshAllData() {
            const topSchool = data.schools.find(s => s.isTop) || data.schools[0];
            const topOffice = data.offices.find(o => o.isTop) || data.offices[0];

            if(topSchool) document.getElementById('topSchoolNameHero').innerText = topSchool['Ù†Ø§Ù…_Ù…Ø¯Ø±Ø³Ù‡'].replace('Ø¯Ø¨ÛŒØ±Ø³ØªØ§Ù† ', '').replace('Ù…Ø¯Ø±Ø³Ù‡ ', '');
            if(topOffice) document.getElementById('topOfficeNameHero').innerText = topOffice['Ù†Ø§Ù…_Ø§Ø¯Ø§Ø±Ù‡'].replace('Ø§Ø¯Ø§Ø±Ù‡ Ø¢Ù…ÙˆØ²Ø´ Ùˆ Ù¾Ø±ÙˆØ±Ø´ ', '');
            renderStatsTables();
        }

        // --- Ø±Ù†Ø¯Ø± Ø¬Ø¯Ø§ÙˆÙ„ Ø¢Ù…Ø§Ø± ---
        function renderStatsTables() {
            const schoolsBody = document.getElementById('schoolsTableBody');
            schoolsBody.innerHTML = '';
            const sortedSchools = [...data.schools].sort((a,b) => b['Ù…ÛŒØ²Ø§Ù†_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…'] - a['Ù…ÛŒØ²Ø§Ù†_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…']);
            
            sortedSchools.slice(0, 10).forEach((s, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><div class="rank-badge" style="${index === 0 ? 'background:#ffd700' : (index===1 ? 'background:#c0c0c0' : (index===2 ? 'background:#cd7f32' : 'background:#eee'))}">${index + 1}</div></td>
                    <td>${s['Ù†Ø§Ù…_Ù…Ø¯Ø±Ø³Ù‡']}</td>
                    <td>${s['Ù…Ù†Ø·Ù‚Ù‡']}</td>
                    <td style="font-weight:bold; color:var(--primary-dark)">${s['Ù…ÛŒØ²Ø§Ù†_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…']}</td>
                    <td>${s['Ù…ÛŒØ²Ø§Ù†_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…'] >= 250 ? 'ğŸŒ² Ø¯Ø±Ø®Øª Ú©Ø§Ù…Ù„' : 'ğŸŒ± Ø¯Ø± Ø­Ø§Ù„ Ø±Ø´Ø¯'}</td>
                `;
                schoolsBody.appendChild(tr);
            });

            const officesBody = document.getElementById('officesTableBody');
            officesBody.innerHTML = '';
            const sortedOffices = [...data.offices].sort((a,b) => b['Ø¬Ù…Ø¹_Ú©Ù„_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…'] - a['Ø¬Ù…Ø¹_Ú©Ù„_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…']);

            sortedOffices.forEach((o, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><div class="rank-badge">${index + 1}</div></td>
                    <td>${o['Ù†Ø§Ù…_Ø§Ø¯Ø§Ø±Ù‡']}</td>
                    <td>${o['ØªØ¹Ø¯Ø§Ø¯_Ù…Ø¯Ø§Ø±Ø³']}</td>
                    <td style="font-weight:bold; color:var(--primary-dark)">${o['Ø¬Ù…Ø¹_Ú©Ù„_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…']}</td>
                    <td>${Math.floor(o['Ø¬Ù…Ø¹_Ú©Ù„_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…'] / 250)} Ø¯Ø±Ø®Øª</td>
                `;
                officesBody.appendChild(tr);
            });
        }

        // --- Ø¢Ù¾Ø¯ÛŒØª Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù…Ø¯Ø±Ø³Ù‡ ---
        function updateSchoolProfile() {
            const school = data.schools.find(s => s.isTop) || data.schools[0];
            if(!school) return;

            document.getElementById('schoolProfileName').innerText = school['Ù†Ø§Ù…_Ù…Ø¯Ø±Ø³Ù‡'];
            document.getElementById('schoolProfileRegion').innerText = `${school['Ù…Ù†Ø·Ù‚Ù‡']} | Ú©Ø¯: ${school['Ú©Ø¯'] || '-'}`;
            
            const weight = school['Ù…ÛŒØ²Ø§Ù†_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…'];
            const target = 250;
            const percent = Math.min(Math.round((weight / target) * 100), 100);
            
            const circle = document.getElementById('schoolProgressCircle');
            const circumference = 2 * Math.PI * 90;
            const offset = circumference - (percent / 100) * circumference;
            
            setTimeout(() => {
                circle.style.strokeDashoffset = offset;
                document.getElementById('schoolPercentText').innerText = percent + '%';
            }, 500);

            document.getElementById('schoolWeightText').innerText = weight + ' kg';
            document.getElementById('schoolRankText').innerText = 'Û±';

            for(let i=1; i<=5; i++) {
                const layer = document.getElementById(`sl-${i}`);
                layer.style.opacity = '0.3';
                layer.style.transform = 'translateX(-50%) scale(0.8)';
                
                if(percent >= i*20) {
                    setTimeout(() => {
                        layer.style.opacity = '1';
                        layer.style.transform = 'translateX(-50%) scale(1)';
                        layer.style.background = getComputedStyle(document.documentElement).getPropertyValue(`--primary-color`);
                    }, i * 300);
                }
            }
        }

        // --- Ø¢Ù¾Ø¯ÛŒØª Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø§Ø¯Ø§Ø±Ù‡ ---
        function updateOfficeProfile() {
            const office = data.offices.find(o => o.isTop) || data.offices[0];
            if(!office) return;

            document.getElementById('officeProfileName').innerText = office['Ù†Ø§Ù…_Ø§Ø¯Ø§Ø±Ù‡'];
            document.getElementById('officeProfileStats').innerText = `Ù…Ø¯Ø§Ø±Ø³: ${office['ØªØ¹Ø¯Ø§Ø¯_Ù…Ø¯Ø§Ø±Ø³']} | Ø¬Ù…Ø¹ Ú©Ù„: ${office['Ø¬Ù…Ø¹_Ú©Ù„_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…']} kg`;
            
            const treeCount = Math.floor(office['Ø¬Ù…Ø¹_Ú©Ù„_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…'] / 250);
            document.getElementById('officeTreeCount').innerText = treeCount;
            document.getElementById('officeAvgWeight').innerText = Math.round(office['Ø¬Ù…Ø¹_Ú©Ù„_Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ_Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…'] / office['ØªØ¹Ø¯Ø§Ø¯_Ù…Ø¯Ø§Ø±Ø³']) + ' kg';

            const grid = document.getElementById('officeForestGrid');
            grid.innerHTML = '';
            
            const displayTrees = Math.min(treeCount, 50);
            
            for(let i=0; i<displayTrees; i++) {
                const div = document.createElement('div');
                div.className = 'forest-tree-item';
                div.innerText = 'ğŸŒ²';
                div.style.animationDelay = (i * 0.05) + 's';
                grid.appendChild(div);
            }
            if(treeCount > 50) {
                const more = document.createElement('div');
                more.innerText = `+${treeCount - 50} Ø¨ÛŒØ´ØªØ±...`;
                more.style.gridColumn = '1 / -1';
                more.style.textAlign = 'center';
                more.style.color = 'var(--primary-dark)';
                grid.appendChild(more);
            }
        }

        // --- Ù…Ù†Ø·Ù‚ Ø§Ù…Ù†ÛŒØª OTP ---
        let generatedOTP = null;
        const ALLOWED_EMAIL = 'afsharmanesh.ehsan@gmail.com';

        function requestOTP() {
            const email = document.getElementById('emailInput').value.toLowerCase().trim();
            if (email !== ALLOWED_EMAIL) {
                alert('Ø¯Ø³ØªØ±Ø³ÛŒ ØºÛŒØ±Ù…Ø¬Ø§Ø²! Ø§ÛŒÙ…ÛŒÙ„ ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ Ø§Ø¬Ø§Ø²Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ø¯Ø§Ø±Ø¯.');
                return;
            }

            // ØªÙˆÙ„ÛŒØ¯ Ú©Ø¯ 5 Ø±Ù‚Ù…ÛŒ ØªØµØ§Ø¯ÙÛŒ
            generatedOTP = Math.floor(10000 + Math.random() * 90000);
            
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø§ÛŒÙ…ÛŒÙ„ (Ø¯Ø± ÙˆØ§Ù‚Ø¹ÛŒØª Ø¨Ø§ÛŒØ¯ Ø¨Ø§ Ø³Ø±ÙˆØ± Ø§Ù†Ø¬Ø§Ù… Ø´ÙˆØ¯)
            alert(`Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ø¨Ù‡ Ø§ÛŒÙ…ÛŒÙ„ ${email} Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.\nÚ©Ø¯ Ø´Ù…Ø§ Ø¨Ø±Ø§ÛŒ ØªØ³Øª: ${generatedOTP}`);
            
            document.getElementById('emailStep').style.display = 'none';
            document.getElementById('otpStep').style.display = 'block';
        }

        function verifyOTP() {
            const input = document.getElementById('otpInput').value;
            if (input == generatedOTP) {
                document.getElementById('loginCard').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
            } else {
                alert('Ú©Ø¯ ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª.');
            }
        }

        function resetLogin() {
            document.getElementById('otpStep').style.display = 'none';
            document.getElementById('emailStep').style.display = 'block';
            document.getElementById('otpInput').value = '';
            generatedOTP = null;
        }

    </script>
</body>
</html>
